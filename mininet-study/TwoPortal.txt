sudo ip link add h12-eth0 type veth peer name pollux-eth12
sleep 1
sudo ip netns add h12
sudo ip link set h12-eth0 netns h12
sudo ip netns exec h12 ifconfig h12-eth0 10.10.12.2/24
sudo ifconfig pollux-eth12 10.10.12.1/24
sudo ip netns exec h12 ifconfig lo up
sudo ip netns exec h12 ping -c1 10.10.12.1
sudo  ping -c1 10.10.12.2
sudo ip netns exec h12 ip route add 192.168.0.0/16 via 10.10.12.1
#sudo ip netns exec h12 ip route add 10.10.13.0/24 via 10.10.12.1


#Compile Model:
#------------------
java -DRUNTIME_ENV=[c_slave1,d_slave1,eth2,10.10.12.1] -DPORTAL_LINKS=c_slave1:eth2,topnet.left_net.r.portal_if_10_10_12_0 -jar ~/primogeni/netscript/dist/jprime.jar create two_portal TwoPortal.java 192.168.0.0/16
#java -DRUNTIME_ENV=[c_slave1,d_slave1,eth2,10.10.12.1] -DPORTAL_LINKS=c_slave1:eth2,topnet.left_net.r.portal_if_10_10_12_0 -jar ~/primogeni/netscript/dist/jprime.jar create two_portal_hybrid_traffic TwoPortalHybridTraffic.java 192.168.0.0/16

#Run Model:(Pollux)
#---------
/root/primogeni_test/netsim/primex -tp 10.10.12.1 111  600 /root/expt/hybrid_traffic/two_portal_part_1.tlv

#/root/primogeni_test/netsim/primex -tp 10.10.12.1 111  600 /root/expt/hybrid_traffic/two_portal_hybrid_traffic_part_1.tlv


#Testing
#------
sudo ip netns exec h12  ping 10.10.12.1
sudo ip netns exec h12  ping 192.168.0.1
#sudo ip netns exec h12 python -m SimpleHTTPServer 80


#Saving wget 
cd ~/wget
sudo ip netns exec h12 wget 192.168.0.1/1000
sudo ip netns exec h12 wget 192.168.0.1/10000
sudo ip netns exec h12 wget 192.168.0.1/100000
sudo ip netns exec h12 wget 192.168.0.1/1000000





Results:
root@pollux:~/wget# sudo ip netns exec h12  ping 192.168.0.1
PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.
64 bytes from 192.168.0.1: icmp_req=1 ttl=62 time=2.26 ms
64 bytes from 192.168.0.1: icmp_req=2 ttl=62 time=2.27 ms
64 bytes from 192.168.0.1: icmp_req=3 ttl=62 time=2.27 ms
^C
--- 192.168.0.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 2.261/2.270/2.278/0.055 ms
root@pollux:~/wget# ls
1000  1000.1  index.html  index.html.1  index.html.2


root@pollux:~/wget# sudo ip netns exec h12 wget 192.168.0.1/1000
--2015-03-27 15:16:01--  http://192.168.0.1/1000
Connecting to 192.168.0.1:80... connected.
HTTP request sent, awaiting response... 200 
Length: 1024000 (1000K) [text/html]
Saving to: `1000'

100%[==================================================================================>] 1,024,000   --.-K/s   in 0.1s    

2015-03-27 15:16:01 (9.48 MB/s) - `1000' saved [1024000/1024000]

root@pollux:~/wget# sudo ip netns exec h12 wget 192.168.0.1/10000
--2015-03-27 15:16:09--  http://192.168.0.1/10000
Connecting to 192.168.0.1:80... connected.
HTTP request sent, awaiting response... 200 
Length: 10240000 (9.8M) [text/html]
Saving to: `10000.1'

100%[==================================================================================>] 10,240,000  10.6M/s   in 0.9s    

2015-03-27 15:16:10 (10.6 MB/s) - `10000.1' saved [10240000/10240000]

root@pollux:~/wget# sudo ip netns exec h12 wget 192.168.0.1/100000
--2015-03-27 15:16:22--  http://192.168.0.1/100000
Connecting to 192.168.0.1:80... connected.
HTTP request sent, awaiting response... 200 
Length: 102400000 (98M) [text/html]
Saving to: `100000'

100%[==================================================================================>] 102,400,000 10.5M/s   in 9.3s    

2015-03-27 15:16:31 (10.5 MB/s) - `100000' saved [102400000/102400000]

root@pollux:~/wget# sudo ip netns exec h12 wget 192.168.0.1/1000000
--2015-03-27 15:16:35--  http://192.168.0.1/1000000
Connecting to 192.168.0.1:80... connected.
HTTP request sent, awaiting response... 200 
Length: 1024000000 (977M) [text/html]
Saving to: `1000000'

100%[================================================================================>] 1,024,000,000 10.5M/s   in 92s     

2015-03-27 15:18:07 (10.6 MB/s) - `1000000' saved [1024000000/1024000000]
